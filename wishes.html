<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ ‚Äî Happy Birthday</title>
  <style>
    :root{
      --card:#fff; --muted:#7a7a8c; --shadow:0 10px 30px rgba(25,23,40,.12);
      --brand-2:#ffd6e7; --brand-3:#bde0fe; --brand-4:#ffe5a5;
      --bg1:#fefaff; --bg2:#f2f7ff; --bg3:#fff0f6;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0; font-family: ui-rounded, system-ui, "Segoe UI", Poppins, sans-serif; color:#2d2a32;
      background: linear-gradient(135deg,var(--bg1),var(--bg2) 45%,var(--bg3));
      min-height:100%;
    }
    a{color:inherit; text-decoration:none}
    .wrap{max-width:900px; margin:0 auto; padding:24px; position:relative; z-index:1}

    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ü‡∏≠‡∏á‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• */
    .bg-bubbles{position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden}
    .bubble{position:absolute; border-radius:50%; opacity:.28; filter:blur(.3px); animation:floatUp linear infinite}
    @keyframes floatUp{0%{transform:translateY(110vh) scale(.9)}100%{transform:translateY(-10vh) scale(1)}}

    /* ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß */
    header.topbar{
      display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:8px;
      position:sticky; top:0; z-index:2; padding:10px 0;
      backdrop-filter: blur(8px) saturate(1.2);
    }
    .btn{
      appearance:none; border:1px solid rgba(0,0,0,.08); background:var(--card);
      padding:10px 14px; border-radius:14px; font-weight:600; cursor:pointer; box-shadow: var(--shadow);
      position:relative; overflow:hidden; transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .btn::after{content:"";position:absolute;inset:0;background:linear-gradient(120deg,#ffffffa0,#ffffff00 40%);transform:translateX(-120%);transition:transform .45s ease}
    .btn:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(189,224,254,.28),var(--shadow);border-color:rgba(0,0,0,.12)}
    .btn:hover::after{transform:translateX(0)}
    .btn.brand{background:linear-gradient(120deg,var(--brand-2),var(--brand-3)); border:none}

    .card{background:var(--card); border:1px solid rgba(0,0,0,.06); border-radius:24px; padding:22px; box-shadow:var(--shadow)}
    .chip{display:inline-block; padding:6px 10px; border-radius:999px; background:linear-gradient(120deg,var(--brand-4),var(--brand-2)); font-weight:700; font-size:12px}
    .lead{color:var(--muted)}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap; margin:14px 0 10px}

    /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ */
    .wish-block{position:relative; overflow:hidden}
    .wish-block::before{
      content:""; position:absolute; inset:-20% -10%;
      background:repeating-conic-gradient(from 0deg, #ffd6e720 0deg 20deg, #bde0fe20 20deg 40deg);
      animation:spin 22s linear infinite; z-index:0;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .wish-text{
      position:relative; z-index:1;
      font-size:clamp(16px,2.1vw,20px); line-height:1.9; color:#444;
      background:conic-gradient(from 180deg at 50% 0%, #fff 0 25%, #fff8 0 35%, #fff 0 60%, #fff8 0 70%, #fff 0 100%), linear-gradient(120deg, #fff0, #ffe9f5), var(--card);
      border-radius:22px; padding:18px;
    }

    /* ‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏û‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏•‡∏á */
    .player{display:grid; gap:14px; justify-items:center; margin:10px 0 18px}
    .disc-wrap{position:relative; display:grid; place-items:center}
    .disc{width:min(72vw,260px); aspect-ratio:1/1; border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #555 0 6%, #333 7% 50%, #111 52% 100%);
      box-shadow: inset 0 0 0 6px #222, inset 0 0 0 12px #111;
      animation:spinDisc 6s linear infinite; animation-play-state:paused}
    @keyframes spinDisc{to{transform:rotate(360deg)}}
    .disc-cover{position:absolute; inset:14% 14%; width:72%; height:72%; border-radius:50%; object-fit:cover; box-shadow:0 0 0 6px #fff7}
    .disc-hole{position:absolute; left:50%; top:50%; width:10px; height:10px; margin:-5px 0 0 -5px; background:#eee; border-radius:50%}
    .tonearm{position:absolute; right:18%; top:6%; width:110px; height:10px; background:#333; transform-origin:0 50%; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,.2); transform:rotate(-8deg)}
    .row{display:flex; gap:10px; justify-content:center; flex-wrap:wrap}

    /* Visualizer */
    #vizCanvas{width:min(86vw,640px); height:70px; display:block; border-radius:12px; background:linear-gradient(180deg,#ffffff80,#ffffff40); box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}
    footer{padding:30px 0 60px; text-align:center; color:#777}
  </style>
</head>
<body>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ü‡∏≠‡∏á‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• -->
  <div class="bg-bubbles" id="bubbles"></div>

  <main class="wrap">
    <header class="topbar">
      <h1 style="margin:0">üíå ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£</h1>
      <a class="btn" href="index.html">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
    </header>

    <!-- ‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏û‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏•‡∏á -->
    <section class="card">
      <span class="chip">üéµ ‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®</span>
      <div class="player">
        <div class="disc-wrap">
          <div class="disc paused" id="disc">
            <img src="/assets/cover.jpg" alt="cover" class="disc-cover" />
            <div class="disc-hole"></div>
          </div>
          <div class="tonearm" id="tonearm"></div>
        </div>
        <canvas id="vizCanvas" aria-hidden="true"></canvas>
        <div class="row">
          <button class="btn brand" id="togglePlay">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á</button>
          <input type="range" id="volume" min="0" max="1" step="0.01" value="0.8" aria-label="Volume">
        </div>
        <p class="lead" style="margin:0">‡πÄ‡∏û‡∏•‡∏á + ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£</p>
        <audio id="audio" preload="auto">
          <source src="song.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </section>

    <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ß‡∏¢‡∏û‡∏£ -->
    <section class="card" style="margin-top:18px">
      <div class="toolbar">
        <button class="btn" id="randomWish">‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£</button>
        <button class="btn" id="autoToggle">üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥: ‡∏õ‡∏¥‡∏î</button>
        <button class="btn brand" id="copyWish">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
        <button class="btn" id="shareWish">‡πÅ‡∏ä‡∏£‡πå</button>
      </div>
      <div class="wish-block">
        <div class="wish-text" id="wishText" contenteditable>
          ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏î‡∏µ ‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞
          ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å‡∏ú‡∏•‡∏á‡∏î‡∏á‡∏≤‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á‡∏ö‡∏ß‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
          ‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Ñ‡∏ô‡∏î‡∏µ ‡πÜ ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏î‡∏µ ‡πÜ ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏ß‡∏±‡∏á‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏™‡∏°‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ üå∑‚ú®
        </div>
      </div>
      <p class="lead" style="font-size:12px;margin-top:8px">* ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡∏•‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
    </section>

    <footer>‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‚ú®</footer>
  </main>

  <script>
    /* ‡∏ü‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• */
    const colors=['#ffd6e7','#bde0fe','#95d5b2','#ffe5a5','#ffc8dd'];
    const bubbles=document.getElementById('bubbles');
    for(let i=0;i<22;i++){
      const b=document.createElement('div');
      b.className='bubble';
      const size=28+Math.random()*90;
      b.style.width=b.style.height=size+'px';
      b.style.left=Math.random()*100+'%';
      b.style.background=colors[(Math.random()*colors.length)|0];
      b.style.animationDuration=(16+Math.random()*18)+'s';
      b.style.animationDelay=(-Math.random()*20)+'s';
      bubbles.appendChild(b);
    }

    /* ‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏û‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå + Visualizer + Volume (GainNode) */
    const audio=document.getElementById('audio');
    const disc=document.getElementById('disc');
    const toggle=document.getElementById('togglePlay');
    const vol=document.getElementById('volume');
    const tone=document.getElementById('tonearm');
    const viz=document.getElementById('vizCanvas');
    const vctx=viz.getContext('2d');

    function fitCanvas(){ viz.width=viz.clientWidth; viz.height=viz.clientHeight; }
    addEventListener('resize', fitCanvas); fitCanvas();

    let ac, analyser, gainNode, raf;

    async function ensureAudioGraph(){
      if(ac) return;
      ac = new (window.AudioContext||window.webkitAudioContext)();
      analyser = ac.createAnalyser();
      analyser.fftSize = 512;

      gainNode = ac.createGain();
      gainNode.gain.value = +vol.value;           // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡πÑ‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå

      const track = ac.createMediaElementSource(audio);
      // track ‚Üí analyser ‚Üí gain ‚Üí destination
      track.connect(analyser);
      analyser.connect(gainNode);
      gainNode.connect(ac.destination);
    }

    function setPaused(p){
      disc.style.animationPlayState=p?'paused':'running';
      toggle.textContent=p?'‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á':'‚è∏ ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á';
      tone.style.transform=p?'rotate(-8deg)':'rotate(12deg)';
    }
    setPaused(true);

    function drawViz(){
      const buffer = new Uint8Array(analyser.frequencyBinCount);
      analyser.getByteFrequencyData(buffer);
      vctx.clearRect(0,0,viz.width,viz.height);
      const nBars = 48, gap = 4;
      const barW = (viz.width - (nBars-1)*gap)/nBars;
      for(let i=0;i<nBars;i++){
        const v = buffer[Math.floor(i*buffer.length/nBars)];
        const h = (v/255) * viz.height;
        const x = i*(barW+gap);
        const y = viz.height - h;
        vctx.fillStyle = `rgba(189,224,254,.9)`;
        vctx.fillRect(x,y,barW,h);
        vctx.fillStyle = 'rgba(255,214,231,.9)';
        vctx.fillRect(x, y-3, barW, 3);
      }
      raf = requestAnimationFrame(drawViz);
    }

    toggle.addEventListener('click', async ()=>{
      if(audio.paused){
        try{
          await ensureAudioGraph();
          await audio.play(); setPaused(false);
          cancelAnimationFrame(raf); raf = requestAnimationFrame(drawViz);
        }catch{
          alert('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å auto-play ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏Ñ‡πà‡∏∞');
        }
      }else{
        audio.pause(); setPaused(true);
        cancelAnimationFrame(raf);
      }
    });
    audio.addEventListener('ended',()=>{
      setPaused(true);
      cancelAnimationFrame(raf);
    });

    // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡πà‡∏≤‡∏ô GainNode (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á graph ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà audio ‡πÄ‡∏õ‡πá‡∏ô fallback)
    vol.addEventListener('input', async e=>{
      const value = +e.target.value;
      if(!ac){ audio.volume = value; }           // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Å‡∏î‡πÄ‡∏•‡πà‡∏ô
      if(!gainNode){ await ensureAudioGraph(); } // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ
      if(gainNode) gainNode.gain.value = value;
    });

    /* ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ */
    const wishText=document.getElementById('wishText');
    const wishes=[
      '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡πà‡∏∞ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏î‡πÉ‡∏™‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏î‡∏µ ‡πÜ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à ü´∂üèª',
      '‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏á ‡πÜ ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡∏°‡∏≤‡πÄ‡∏ó‡∏°‡∏≤ ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡πÉ‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏™‡∏∏‡∏î ‡πÜ üéâ',
      '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏õ‡∏µ ‡πÅ‡∏ï‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏¢‡∏±‡∏á‡∏™‡∏î‡πÉ‡∏™‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ô‡∏∞ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÜ ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏ß‡∏µ‡∏Ñ‡∏π‡∏ì üå∏',
      '‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ô‡∏î‡∏µ ‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á ‡πÜ ‡πÄ‡∏™‡∏°‡∏≠ Happy Birthday! üéÇ',
      '‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏ö‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡∏°‡πà ‡πÜ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏Å‡πá‡πÄ‡∏à‡∏≠‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô üí´'
    ];

    function typeText(el, text){
      el.innerText=''; let i=0;
      const timer=setInterval(()=>{ el.innerText += text[i++]||''; if(i>=text.length) clearInterval(timer); },18);
    }

    // confetti ‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏ï‡∏≠‡∏ô‡∏™‡∏∏‡πà‡∏°/‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
    function popConfetti(){
      const count=18;
      for(let i=0;i<count;i++){
        const s=document.createElement('span');
        s.style.position='fixed';
        s.style.left=(window.innerWidth/2 + (Math.random()*200-100))+'px';
        s.style.top=(window.innerHeight/2 + (Math.random()*60-30))+'px';
        s.style.width=s.style.height=(4+Math.random()*6)+'px';
        s.style.background=colors[(Math.random()*colors.length)|0];
        s.style.borderRadius='2px';
        s.style.transform=`translateY(0) rotate(${Math.random()*360}deg)`;
        s.style.transition='transform 900ms ease, opacity 900ms ease';
        s.style.zIndex=9;
        document.body.appendChild(s);
        requestAnimationFrame(()=>{
          s.style.transform=`translateY(${120+Math.random()*120}px) rotate(${Math.random()*360}deg)`;
          s.style.opacity='0';
        });
        setTimeout(()=>s.remove(),1000);
      }
    }

    document.getElementById('randomWish').addEventListener('click', ()=>{
      const t=wishes[(Math.random()*wishes.length)|0];
      typeText(wishText,t);
      popConfetti();
    });

    document.getElementById('copyWish').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(wishText.innerText.trim()); popConfetti(); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚ú®'); }
      catch{ alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); }
    });

    // ‡πÅ‡∏ä‡∏£‡πå (Web Share > LINE fallback)
    document.getElementById('shareWish').addEventListener('click', async ()=>{
      const text = wishText.innerText.trim();
      const shareData = { title:'‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î', text };
      if(navigator.share){
        try{ await navigator.share(shareData); }catch{}
      }else{
        const url = 'https://line.me/R/msg/text/?' + encodeURIComponent(text);
        window.open(url,'_blank');
      }
    });

    // ‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    let autoTimer=null, autoOn=false;
    const autoBtn=document.getElementById('autoToggle');
    function setAuto(on){
      autoOn=on;
      autoBtn.textContent = `‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥: ${on?'‡πÄ‡∏õ‡∏¥‡∏î':'‡∏õ‡∏¥‡∏î'}`;
      if(autoTimer) clearInterval(autoTimer), autoTimer=null;
      if(on){
        autoTimer=setInterval(()=>{
          const t=wishes[(Math.random()*wishes.length)|0];
          typeText(wishText,t);
        }, 6000);
      }
    }
    autoBtn.addEventListener('click',()=> setAuto(!autoOn));

    // ‡∏õ‡∏±‡∏î‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤ ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°
    let sx=0, sy=0, st=0;
    wishText.addEventListener('touchstart',e=>{
      const t=e.changedTouches[0]; sx=t.clientX; sy=t.clientY; st=Date.now();
    },{passive:true});
    wishText.addEventListener('touchend',e=>{
      const t=e.changedTouches[0], dx=t.clientX-sx, dy=t.clientY-sy, dt=Date.now()-st;
      if(Math.abs(dx)>40 && Math.abs(dx)>Math.abs(dy) && dt<600){
        const txt=wishes[(Math.random()*wishes.length)|0];
        typeText(wishText,txt);
      }
    },{passive:true});
  </script>
</body>
</html>
